HTTP интерфейс для тестов
http://10.112.30.100:8080/vlm.html
telnet порт по умолчанию 4212

Тестовые камеры
http://10.112.30.100:9001 - без звука
http://10.112.30.100:9002 - со звуком, идет перекодировка из mlaw в mp3, возможно нет кодека mlaw
telnet://127.0.0.1:4301
telnet://127.0.0.1:4302
пароль 12345
комманда show, control cam# play, control cam# stop (как в vlm файле)
Китайскую камеру нужно стопить и плеить что бы заработала опять, это ее косяк, а не vlc
Процессы запущены демоном, сомтрим на их жизнь
killall vlc не делаем
Коннектимся телнетом и shutdown

Кодеки и контейнеры
http://www.videolan.org/streaming-features.html
Используем контейнер ts (MPEG-TS?), держит почти все кодеки


========
Система:

1 клиент - 1 vlc процесс
на 1 vlc процесс можно повесить много камер только этого пользователя
запуск vlc процесса должен быть из скрипта, который будет сохранять PID(!) vlc для данного клиента

стопить процессы будет через kill PID
проверять жизнь процессов для клиентов будем через PID
для этого и нужен PID!

для каждого vlc будет свой порт telnet
Через telnet можно управлять потоками vlc
их можно stop, play, disable,enable, kill процесса
нумерация потров telnet начинается с 44300+[номер клиента]
нумерация портов для камер на http с 9000+[номер камеры]

VLM файлы
1 vlm файл - 1 клиент? (можно 1 vlm на камеру для удобства управления через скрипты)
много камер клиента - 1 vlm файл
тестить нужно кодеки и звук
пока виндовз медиа 2, вродь работает с этой китайской камерой

Всю систему управления думаю делать на PHP

1) ./bin - шаблонный файлы для запуска vlc процессов, генерятся с помощью PHP, стартуют через PHP, записывя PID
2) ./etc - копилка для vlm файлов, тоже шаблонная
3) ./rec - записи, нужно будет бить по файлам, по времени, по камерам и клиентам
4) системный кронд будет смотерт все запущенные vlc PIDы, если их нет в списке запомненых - kill, если кого то из списка нет запускаем vlc для клиента
5) в 3 часа ночи по кронду убиваем все vlc??? режем видео файлы, включаем vlc
6) PHP может всё делать через telnet
7) придумать перезапуск камер при отсутствии картинки (эта вебка этим страдает), например через ffmpeg держать кадр и сомтреть
8) записанные файлы при прерывании по ctrl+c иди kill теряют целостность, vlc показывает, а windows media нет, нужно их причесывать

кстати, vlm можно лоадить через телнет интерфейс
комманды такие же как и в файле vlm
control cam1 play
control cam1 stop
etc...

Интерфейс telnet

Welcome, Master
> help
+----[ VLM commands ]
|help
|    Commands Syntax:
|        new (name) vod|broadcast|schedule [properties]
|        setup (name) (properties)
|        show [(name)|media|schedule]
|        del (name)|all|media|schedule
|        control (name) [instance_name] (command)
|        save (config_file)
|        export
|        load (config_file)
|    Media Proprieties Syntax:
|        input (input_name)
|        inputdel (input_name)|all
|        inputdeln input_number
|        output (output_name)
|        option (option_name)[=value]
|        enabled|disabled
|        loop|unloop (broadcast only)
|        mux (mux_name)
|    Schedule Proprieties Syntax:
|        enabled|disabled
|        append (command_until_rest_of_the_line)
|        date (year)/(month)/(day)-(hour):(minutes):(seconds)|now
|        period (years_aka_12_months)/(months_aka_30_days)/(days)-(hours):(minutes):(seconds)
|        repeat (number_of_repetitions)
|    Control Commands Syntax:
|        play [input_number]
|        pause
|        stop
|        seek [+-](percentage) | [+-](seconds)s | [+-](milliseconds)ms
+----[ CLI commands ]
| add XYZ  . . . . . . . . . . . . . . . . . . . . add XYZ to playlist
| enqueue XYZ  . . . . . . . . . . . . . . . . . queue XYZ to playlist
| playlist . . . . . . . . . . . . . .show items currently in playlist
| search [string]  . .  search for items in playlist (or reset search)
| sort key . . . . . . . . . . . . . . . . . . . . . sort the playlist
| sd [sd]  . . . . . . . . . . . . . show services discovery or toggle
| play . . . . . . . . . . . . . . . . . . . . . . . . . . play stream
| stop . . . . . . . . . . . . . . . . . . . . . . . . . . stop stream
| next . . . . . . . . . . . . . . . . . . . . . .  next playlist item
| prev . . . . . . . . . . . . . . . . . . . .  previous playlist item
| goto, gotoitem . . . . . . . . . . . . . . . . . .goto item at index
| repeat [on|off]  . . . . . . . . . . . . . .  toggle playlist repeat
| loop [on|off]  . . . . . . . . . . . . . . . .  toggle playlist loop
| random [on|off]  . . . . . . . . . . . . . .  toggle playlist random
| clear  . . . . . . . . . . . . . . . . . . . . . .clear the playlist
| status . . . . . . . . . . . . . . . . . . . current playlist status
| title [X]  . . . . . . . . . . . . . . set/get title in current item
| title_n  . . . . . . . . . . . . . . . .  next title in current item
| title_p  . . . . . . . . . . . . . .  previous title in current item
| chapter [X]  . . . . . . . . . . . . set/get chapter in current item
| chapter_n  . . . . . . . . . . . . . .  next chapter in current item
| chapter_p  . . . . . . . . . . . .  previous chapter in current item
|
| seek X . . . . . . . . . . . seek in seconds, for instance `seek 12'
| pause  . . . . . . . . . . . . . . . . . . . . . . . .  toggle pause
| fastforward  . . . . . . . . . . . . . . . . . . set to maximum rate
| rewind . . . . . . . . . . . . . . . . . . . . . set to minimum rate
| faster . . . . . . . . . . . . . . . . . .  faster playing of stream
| slower . . . . . . . . . . . . . . . . . .  slower playing of stream
| normal . . . . . . . . . . . . . . . . . .  normal playing of stream
| rate [playback rate] . . . . . . . . . .  set playback rate to value
| frame  . . . . . . . . . . . . . . . . . . . . . play frame by frame
| fullscreen, f, F [on|off]  . . . . . . . . . . . . toggle fullscreen
| info . . . . . . . . . . . . . .information about the current stream
| stats  . . . . . . . . . . . . . . . .  show statistical information
| get_time . . . . . . . . . .seconds elapsed since stream's beginning
| is_playing . . . . . . . . . . . .  1 if a stream plays, 0 otherwise
| get_title  . . . . . . . . . . . . . the title of the current stream
| get_length . . . . . . . . . . . .  the length of the current stream
|
| volume [X] . . . . . . . . . . . . . . . . . .  set/get audio volume
| volup [X]  . . . . . . . . . . . . . . . .raise audio volume X steps
| voldown [X]  . . . . . . . . . . . . . .  lower audio volume X steps
| adev [X] . . . . . . . . . . . . . . . . . . . .set/get audio device
| achan [X]  . . . . . . . . . . . . . . . . . .set/get audio channels
| atrack [X] . . . . . . . . . . . . . . . . . . . set/get audio track
| vtrack [X] . . . . . . . . . . . . . . . . . . . set/get video track
| vratio [X] . . . . . . . . . . . . . . . .set/get video aspect ratio
| vcrop, crop [X]  . . . . . . . . . . . . . . . .  set/get video crop
| vzoom, zoom [X]  . . . . . . . . . . . . . . . .  set/get video zoom
| vdeinterlace [X] . . . . . . . . . . . . . .set/get video deintelace
| vdeinterlace_mode [X]  . . . . . . . . set/get video deintelace mode
| snapshot . . . . . . . . . . . . . . . . . . . . take video snapshot
| strack [X] . . . . . . . . . . . . . . . . . set/get subtitles track
|
| vlm  . . . . . . . . . . . . . . . . . . . . . . . . . .load the VLM
| description  . . . . . . . . . . . . . . . . . .describe this module
| help, ? [pattern]  . . . . . . . . . . . . . . . . . .a help message
| longhelp [pattern] . . . . . . . . . . . . . . a longer help message
| lock . . . . . . . . . . . . . . . . . . . .  lock the telnet prompt
| logout . . . . . . . . . . . . . .  exit (if in a socket connection)
| quit . . . . . . . .  quit VLC (or logout if in a socket connection)
| shutdown . . . . . . . . . . . . . . . . . . . . . . . .shutdown VLC
+----[ end of help ]


1280x720: rtsp://192.168.1.1:554/live/ch00_0
640x480: rtsp://192.168.1.1:554/live/ch01_0
(ch02 and ch03 removed until future firmware release)
320x240: rtsp://192.168.1.1:554/live/ch02_0
160x120: rtsp://192.168.1.1:554/live/ch03_0
